var MagicOAuthExtension=(()=>{var he=Object.create;var I=Object.defineProperty;var ve=Object.getOwnPropertyDescriptor;var ge=Object.getOwnPropertyNames,z=Object.getOwnPropertySymbols,ye=Object.getPrototypeOf,L=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var q=(t,r,i)=>r in t?I(t,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[r]=i,$=(t,r)=>{for(var i in r||(r={}))L.call(r,i)&&q(t,i,r[i]);if(z)for(var i of z(r))me.call(r,i)&&q(t,i,r[i]);return t};var M=t=>I(t,"__esModule",{value:!0});var S=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports),j=(t,r)=>{for(var i in r)I(t,i,{get:r[i],enumerable:!0})},N=(t,r,i,_)=>{if(r&&typeof r=="object"||typeof r=="function")for(let h of ge(r))!L.call(t,h)&&(i||h!=="default")&&I(t,h,{get:()=>r[h],enumerable:!(_=ve(r,h))||_.enumerable});return t},D=(t,r)=>N(M(I(t!=null?he(ye(t)):{},"default",!r&&t&&t.__esModule?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t),_e=(t=>(r,i)=>t&&t.get(r)||(i=N(M({}),r,1),t&&t.set(r,i),i))(typeof WeakMap!="undefined"?new WeakMap:0);var C=(t,r,i)=>new Promise((_,h)=>{var w=p=>{try{d(i.next(p))}catch(u){h(u)}},R=p=>{try{d(i.throw(p))}catch(u){h(u)}},d=p=>p.done?_(p.value):Promise.resolve(p.value).then(w,R);d((i=i.apply(t,r)).next())});var V=S((Se,J)=>{J.exports=Magic});var F=S((U,Y)=>{(function(t,r){typeof U=="object"?Y.exports=U=r():typeof define=="function"&&define.amd?define([],r):t.CryptoJS=r()})(U,function(){var t=t||function(r,i){var _=Object.create||function(){function e(){}return function(n){var c;return e.prototype=n,c=new e,e.prototype=null,c}}(),h={},w=h.lib={},R=w.Base=function(){return{extend:function(e){var n=_(this);return e&&n.mixIn(e),(!n.hasOwnProperty("init")||this.init===n.init)&&(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var n in e)e.hasOwnProperty(n)&&(this[n]=e[n]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),d=w.WordArray=R.extend({init:function(e,n){e=this.words=e||[],n!=i?this.sigBytes=n:this.sigBytes=e.length*4},toString:function(e){return(e||u).stringify(this)},concat:function(e){var n=this.words,c=e.words,o=this.sigBytes,g=e.sigBytes;if(this.clamp(),o%4)for(var v=0;v<g;v++){var x=c[v>>>2]>>>24-v%4*8&255;n[o+v>>>2]|=x<<24-(o+v)%4*8}else for(var v=0;v<g;v+=4)n[o+v>>>2]=c[v>>>2];return this.sigBytes+=g,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=r.ceil(n/4)},clone:function(){var e=R.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var n=[],c=function(y){var y=y,A=987654321,B=4294967295;return function(){A=36969*(A&65535)+(A>>16)&B,y=18e3*(y&65535)+(y>>16)&B;var b=(A<<16)+y&B;return b/=4294967296,b+=.5,b*(r.random()>.5?1:-1)}},o=0,g;o<e;o+=4){var v=c((g||r.random())*4294967296);g=v()*987654071,n.push(v()*4294967296|0)}return new d.init(n,e)}}),p=h.enc={},u=p.Hex={stringify:function(e){for(var n=e.words,c=e.sigBytes,o=[],g=0;g<c;g++){var v=n[g>>>2]>>>24-g%4*8&255;o.push((v>>>4).toString(16)),o.push((v&15).toString(16))}return o.join("")},parse:function(e){for(var n=e.length,c=[],o=0;o<n;o+=2)c[o>>>3]|=parseInt(e.substr(o,2),16)<<24-o%8*4;return new d.init(c,n/2)}},m=p.Latin1={stringify:function(e){for(var n=e.words,c=e.sigBytes,o=[],g=0;g<c;g++){var v=n[g>>>2]>>>24-g%4*8&255;o.push(String.fromCharCode(v))}return o.join("")},parse:function(e){for(var n=e.length,c=[],o=0;o<n;o++)c[o>>>2]|=(e.charCodeAt(o)&255)<<24-o%4*8;return new d.init(c,n)}},a=p.Utf8={stringify:function(e){try{return decodeURIComponent(escape(m.stringify(e)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(e){return m.parse(unescape(encodeURIComponent(e)))}},f=w.BufferedBlockAlgorithm=R.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(e){typeof e=="string"&&(e=a.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var n=this._data,c=n.words,o=n.sigBytes,g=this.blockSize,v=g*4,x=o/v;e?x=r.ceil(x):x=r.max((x|0)-this._minBufferSize,0);var y=x*g,A=r.min(y*4,o);if(y){for(var B=0;B<y;B+=g)this._doProcessBlock(c,B);var b=c.splice(0,y);n.sigBytes-=A}return new d.init(b,A)},clone:function(){var e=R.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),s=w.Hasher=f.extend({cfg:R.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){e&&this._append(e);var n=this._doFinalize();return n},blockSize:512/32,_createHelper:function(e){return function(n,c){return new e.init(c).finalize(n)}},_createHmacHelper:function(e){return function(n,c){return new l.HMAC.init(e,c).finalize(n)}}}),l=h.algo={};return h}(Math);return t})});var Q=S((O,G)=>{(function(t,r){typeof O=="object"?G.exports=O=r(F()):typeof define=="function"&&define.amd?define(["./core"],r):r(t.CryptoJS)})(O,function(t){return function(r){var i=t,_=i.lib,h=_.WordArray,w=_.Hasher,R=i.algo,d=[],p=[];(function(){function a(e){for(var n=r.sqrt(e),c=2;c<=n;c++)if(!(e%c))return!1;return!0}function f(e){return(e-(e|0))*4294967296|0}for(var s=2,l=0;l<64;)a(s)&&(l<8&&(d[l]=f(r.pow(s,1/2))),p[l]=f(r.pow(s,1/3)),l++),s++})();var u=[],m=R.SHA256=w.extend({_doReset:function(){this._hash=new h.init(d.slice(0))},_doProcessBlock:function(a,f){for(var s=this._hash.words,l=s[0],e=s[1],n=s[2],c=s[3],o=s[4],g=s[5],v=s[6],x=s[7],y=0;y<64;y++){if(y<16)u[y]=a[f+y]|0;else{var A=u[y-15],B=(A<<25|A>>>7)^(A<<14|A>>>18)^A>>>3,b=u[y-2],ce=(b<<15|b>>>17)^(b<<13|b>>>19)^b>>>10;u[y]=B+u[y-7]+ce+u[y-16]}var fe=o&g^~o&v,ue=l&e^l&n^e&n,de=(l<<30|l>>>2)^(l<<19|l>>>13)^(l<<10|l>>>22),le=(o<<26|o>>>6)^(o<<21|o>>>11)^(o<<7|o>>>25),W=x+le+fe+p[y]+u[y],pe=de+ue;x=v,v=g,g=o,o=c+W|0,c=n,n=e,e=l,l=W+pe|0}s[0]=s[0]+l|0,s[1]=s[1]+e|0,s[2]=s[2]+n|0,s[3]=s[3]+c|0,s[4]=s[4]+o|0,s[5]=s[5]+g|0,s[6]=s[6]+v|0,s[7]=s[7]+x|0},_doFinalize:function(){var a=this._data,f=a.words,s=this._nDataBytes*8,l=a.sigBytes*8;return f[l>>>5]|=128<<24-l%32,f[(l+64>>>9<<4)+14]=r.floor(s/4294967296),f[(l+64>>>9<<4)+15]=s,a.sigBytes=f.length*4,this._process(),this._hash},clone:function(){var a=w.clone.call(this);return a._hash=this._hash.clone(),a}});i.SHA256=w._createHelper(m),i.HmacSHA256=w._createHmacHelper(m)}(Math),t.SHA256})});var Z=S((H,X)=>{(function(t,r){typeof H=="object"?X.exports=H=r(F()):typeof define=="function"&&define.amd?define(["./core"],r):r(t.CryptoJS)})(H,function(t){return function(){var r=t,i=r.lib,_=i.WordArray,h=r.enc,w=h.Base64={stringify:function(d){var p=d.words,u=d.sigBytes,m=this._map;d.clamp();for(var a=[],f=0;f<u;f+=3)for(var s=p[f>>>2]>>>24-f%4*8&255,l=p[f+1>>>2]>>>24-(f+1)%4*8&255,e=p[f+2>>>2]>>>24-(f+2)%4*8&255,n=s<<16|l<<8|e,c=0;c<4&&f+c*.75<u;c++)a.push(m.charAt(n>>>6*(3-c)&63));var o=m.charAt(64);if(o)for(;a.length%4;)a.push(o);return a.join("")},parse:function(d){var p=d.length,u=this._map,m=this._reverseMap;if(!m){m=this._reverseMap=[];for(var a=0;a<u.length;a++)m[u.charCodeAt(a)]=a}var f=u.charAt(64);if(f){var s=d.indexOf(f);s!==-1&&(p=s)}return R(d,p,m)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function R(d,p,u){for(var m=[],a=0,f=0;f<p;f++)if(f%4){var s=u[d.charCodeAt(f-1)]<<f%4*2,l=u[d.charCodeAt(f)]>>>6-f%4*2;m[a>>>2]|=(s|l)<<24-a%4*8,a++}return _.create(m,a)}}(),t.enc.Base64})});var Ce={};j(Ce,{default:()=>Be});var se=D(V());var T={};j(T,{OAuthErrorCode:()=>K,OAuthPayloadMethods:()=>E});var E=(r=>(r.ParseRedirectResult="magic_oauth_parse_redirect_result",r))(E||{}),K=(a=>(a.InvalidRequest="invalid_request",a.InvalidClient="invalid_client",a.InvalidScope="invalid_scope",a.InvalidGrant="invalid_grant",a.UnauthorizedClient="unauthorized_client",a.UnsupportedResponseType="unsupported_response_type",a.UnsupportedGrantType="unsupported_grant_type",a.UnsupportedTokenType="unsupported_token_type",a.AccessDenied="access_denied",a.ServerError="server_error",a.TemporarilyUnavailable="temporarily_unavailable",a))(K||{});var ee=D(Q()),re=D(Z()),te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",ne=typeof window!="undefined"&&!!window.crypto,we=ne&&!!window.crypto.subtle;function Re(t){return Array.from(t).map(r=>te[r%te.length]).join("")}function ie(t){let r=i=>i.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");if(t instanceof ArrayBuffer){let i=new Uint8Array(t),_=Array.from(i).map(w=>String.fromCharCode(w)).join(""),h=btoa(_);return r(h)}return r(re.default.stringify(t))}function Ae(t){return C(this,null,function*(){if(we){let r=new TextEncoder().encode(t);return crypto.subtle.digest("SHA-256",r).then(ie)}return ie((0,ee.default)(t))})}function oe(t){let r=new Uint8Array(t);if(ne)window.crypto.getRandomValues(r);else for(let i=0;i<t;i+=1)r[i]=Math.floor(Math.random()*Math.floor(255));return Re(r)}function ae(){return C(this,null,function*(){let t=oe(128),r=oe(128),i=yield Ae(r);return{verifier:r,challenge:i,state:t}})}var k=class extends se.Extension.Internal{constructor(){super(...arguments);this.name="oauth";this.config={};this.compat={"magic-sdk":">=2.4.6","@magic-sdk/react-native":!1}}loginWithRedirect(r){return this.utils.createPromiEvent(i=>C(this,null,function*(){let{provider:_,query:h}=yield xe.call(this,r);window.location.href=new URL(`/v1/oauth2/${_}/start?${h}`,this.sdk.endpoint).href,i()}))}getRedirectResult(){let r=window.location.search,i=window.location.origin+window.location.pathname;return window.history.replaceState(null,"",i),be.call(this,r)}},P="oauth_redirect_metadata";function xe(t){return C(this,null,function*(){yield this.utils.storage.removeItem(P);let{provider:r,redirectURI:i,scope:_,loginHint:h}=t,{verifier:w,challenge:R,state:d}=yield ae(),p=JSON.stringify({verifier:w,state:d});return yield this.utils.storage.setItem(P,p),{query:[`magic_api_key=${encodeURIComponent(this.sdk.apiKey)}`,`magic_challenge=${encodeURIComponent(R)}`,`state=${encodeURIComponent(d)}`,`platform=${encodeURIComponent("web")}`,_&&`scope=${encodeURIComponent(_.join(" "))}`,i&&`redirect_uri=${encodeURIComponent(i)}`,h&&`login_hint=${encodeURIComponent(h)}`].reduce((m,a)=>a?`${m}&${a}`:m),provider:r,redirectURI:i}})}function be(t){return this.utils.createPromiEvent((r,i)=>C(this,null,function*(){var m;let _=yield this.utils.storage.getItem(P),{verifier:h,state:w}=JSON.parse(_);this.utils.storage.removeItem(P);let R=this.utils.createJsonRpcRequestPayload("magic_oauth_parse_redirect_result",[t,h,w]),d=yield this.request(R),p=d,u=d;u.error&&i(this.createError(u.error,(m=u.error_description)!=null?m:"An error occurred.",{errorURI:u.error_uri,provider:u.provider})),r(p)}))}Object.assign(k,$({},T));var Be=k;return _e(Ce);})();
if (MagicOAuthExtension && MagicOAuthExtension.default != null) { MagicOAuthExtension = Object.assign(MagicOAuthExtension.default, MagicOAuthExtension); delete MagicOAuthExtension.default; }
